# Vue 3 + Uni-app 跨平台开发差异技术文档

> 简单来说，就是需要识别到不同平台的代码开发有差异化，从原理以及本质上了解不同平台，使用标准的开发规范进行编程，尤其是下文中的第三点 “重点差异点与解决方案”。

## 一、文档概述

本文档旨在梳理基于 **Vue 3** 配合 **Uni-app 框架**进行开发时，编译目标为 **H5（Web 浏览器）** 和 **Android APK（原生应用）** 之间的重点技术差异。理解这些差异对于构建稳定、高性能且高度兼容的跨平台应用至关重要，同时针对参数传递等核心问题提供可落地的解决方案。

## 二、核心差异总结：原理与环境

| 特征         | H5 环境（Web）                               | Android APK 环境（原生 / Hybrid）                       |
| ------------ | -------------------------------------------- | ------------------------------------------------------- |
| **底层环境** | 依赖浏览器内核（如 Chromium、WebKit）        | 基于 Android 原生系统 + WebView 或 Uni-app 自定义渲染层 |
| **路由机制** | 采用 H5 History/Hash 模式，依赖 URL 地址     | 原生页面堆栈管理，URL 隐藏，依赖原生跳转 API            |
| **权限模型** | 严格受限，遵循 Web 安全模型，权限获取复杂    | 系统级权限管理，通过原生系统请求，权限范围更丰富        |
| **离线能力** | 依赖 Service Worker、LocalStorage、IndexedDB | 资源包（Assets）打包内置，离线能力强                    |

## 三、重点差异点与解决方案

### 3.1 路由与参数传递（Routing and Parameter Passing）

此差异是开发中**最常见且必须注意**的核心问题，直接影响页面交互逻辑的正确性。

| 差异点         | H5 应用获取方式                                  | Android APK 获取方式                           | 解决方案 / Uni-app 规范                                                                                                |
| -------------- | ------------------------------------------------ | ---------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| **参数获取**   | 依赖浏览器 URL 解析，可使用 `$route.query.id` 等 | **无法**直接使用 `$route.query` 或 H5 路由方法 | **必须统一使用&#x20;**`onLoad(options)`：在任何页面，通过 `onLoad(options)` 钩子接收所有跳转参数，`options` 为参数对象 |
| **跳转 API**   | `uni.navigateTo` 内部转为 H5 路由操作            | `uni.navigateTo` 内部调用原生堆栈管理          | **统一使用 Uni-app 封装 API**：如 `uni.navigateTo` / `uni.redirectTo` / `uni.switchTab`，避免直接使用 Vue Router 方法  |
| **页面栈管理** | 依赖浏览器 Back/Forward 历史记录                 | 原生页面栈，支持手势返回和流畅切换动画         | 注意页面栈层数限制（默认 10 层），频繁跳转场景用 `redirectTo` 替代 `navigateTo`，避免栈溢出                            |

### 3.2 样式、单位与滚动（Styles, Units, and Scrolling）

样式兼容性直接影响跨平台应用的视觉一致性，需重点关注适配单位与滚动体验差异。

| 差异点           | H5 应用（Web）                          | Android APK（原生 / WebView）                                                                  | 解决方案 / Uni-app 规范                                                                                                                        |
| ---------------- | --------------------------------------- | ---------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |
| **适配单位**     | 完全支持 `rem`、`vw/vh` 等 Web 适配单位 | **rpx 是首选**，`vw/vh` 支持有限或存在兼容性问题                                               | **推荐使用 rpx（响应式像素）**：Uni-app 会自动根据屏幕宽度（默认以 750px 为基准）转换为目标平台的适应单位，保证多设备视觉一致                  |
| **滚动体验**     | 依赖浏览器内核，可能出现滚动穿透问题    | 依赖 `<scroll-view>` 或模拟原生滚动，回弹手感可能不一致                                        | 避免对 `<body>` 或根元素直接设置滚动样式；使用 `<scroll-view>` 控制特定区域滚动，解决滚动穿透问题，同时通过 `scroll-y`/`scroll-x` 明确滚动方向 |
| **Web 标准样式** | 完美支持 CSS3 新特性、Flexbox、Grid     | 核心样式兼容性高，但少数 CSS 属性（如 `backdrop-filter`）或高级选择器在 WebView 中可能渲染异常 | 开发后使用 HBuilderX 或 Chrome 远程调试，在 Android 真机上校验样式，针对异常样式通过条件编译适配                                               |

### 3.3 系统能力与文件操作（System Capabilities and IO）

两者在系统权限、原生能力调用及文件操作上差异显著，需针对性设计实现方案。

| 差异点           | H5 应用（Web 浏览器）                                                | Android APK（原生 App）                                                | 解决方案 / Uni-app 规范                                                                                                                                                          |
| ---------------- | -------------------------------------------------------------------- | ---------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **设备权限**     | 权限受限，GPS 精度、摄像头调用等依赖浏览器 API                       | 支持丰富原生权限，如指纹识别、读写文件系统、蓝牙通信等                 | 调用原生能力前，**必须使用&#x20;**`uni.authorize()` 进行权限判断与申请，申请前需在 `manifest.json` 中配置对应权限（如 Android 端的 `android.permission.ACCESS_FINE_LOCATION`）   |
| **推送服务**     | 仅支持 Web Push，兼容性差且依赖浏览器支持                            | 可集成 Uni-Push、FCM 等原生推送 SDK，实现离线消息推送                  | 推送功能为 App 独有，需在 `manifest.json` 中配置原生推送 SDK（如 Uni-Push），并处理推送消息的接收、解析与跳转逻辑                                                                |
| **本地文件存储** | 仅支持 `localStorage`、`sessionStorage` 或 `IndexedDB`，存储容量有限 | 可通过 `uni.saveFile` 等 API 在 App 沙盒内进行文件操作，支持大文件存储 | 涉及大文件（如图片、视频）或离线资源存储时，**使用&#x20;**`uni.getFileSystemManager()` 操作文件系统，避免依赖 Web 存储方案；小数据（如用户 Token）用 `uni.setStorageSync` 持久化 |

### 3.4 性能、调试与部署（Performance, Debugging, and Deployment）

性能优化、调试效率及部署流程的差异，直接影响开发周期与用户体验。

| 差异点         | H5 应用（Web）                                       | Android APK（原生 App）                                                   | 解决方案 / Uni-app 规范                                                                                                                                        |
| -------------- | ---------------------------------------------------- | ------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **调试工具**   | 依赖浏览器 DevTools（Elements、Network、Console 等） | 支持 HBuilderX 内置调试工具，或连接 Chrome 远程调试（`chrome://inspect`） | 调试 App 时，需开启手机 “开发者模式” 与 “USB 调试”，通过 HBuilderX 连接真机 / 模拟器；复杂原生问题（如插件调用异常）使用 Android Studio 的 Logcat 查看原生日志 |
| **跨域问题**   | 存在严格同源策略限制，需配置 CORS 或代理             | 一般无严格同源策略限制，直接请求接口即可                                  | H5 部署时，需在服务器端配置 CORS（允许请求源、方法等），或通过 Nginx 代理转发接口；App 端无需处理跨域，直接调用接口                                            |
| **发布与更新** | 部署到 Web 服务器，用户刷新页面即可实时更新          | 需打包为 APK 文件，通过应用商店 / 渠道分发；更新需重新安装或热更新        | 生产环境配置 **热更新（wgt 包）**：小版本迭代（无原生插件变更）用热更新，避免用户重新安装；大版本更新（含原生插件变更）需重新打包 APK 提交应用商店审核         |

## 四、关键结论：开发指导原则

1. **参数传递统一化**：无论目标平台是 H5 还是 App，**永远使用&#x20;**`uni.navigateTo({ url: '页面路径?参数名=参数值' })` 进行跳转，并在目标页面通过 `onLoad(options)` 接收参数（`options.参数名` 获取具体值），禁止混用 Vue Router 方法。

2. **API 抽象层统一**：优先使用 **Uni-app 封装的&#x20;**`uni`**&#x20;API**（如 `uni.request` 替代 `fetch`/`axios`、`uni.setStorage` 替代 `localStorage`），减少平台专属 API 依赖，这是实现跨平台兼容的核心基石。

3. **原生差异处理**：针对 App 独有功能（如推送、指纹识别），使用 **条件编译指令** 隔离平台代码：

- App 端专属代码：`#ifdef APP-PLUS ... #endif`

- H5 端排除代码：`#ifndef H5 ... #endif`

  避免因平台专属代码导致另一平台运行报错。

> （注：文档部分内容可能由 AI 生成）
